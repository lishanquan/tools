## æ‰©å®¹åé‡æ–°åˆ†é…ç£ç›˜ç©ºé—´æ“ä½œæ­¥éª¤

##### èƒŒæ™¯ï¼š

```bash
[root@iZwz9cjtn9q0w4kzzoawn5Z /]# lsblk
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
vda    253:0    0   200G  0 disk 
â”œâ”€vda1 253:1    0     2M  0 part 
â”œâ”€vda2 253:2    0   200M  0 part /boot/efi
â””â”€vda3 253:3    0 199.8G  0 part /
vdb    253:16   0   4.9T  0 disk 
â””â”€vdb1 253:17   0   500G  0 part /data
```

åŸæ•°æ®ç›˜å¤§å°ä¸º500Gï¼Œç°æ‰©å®¹åˆ°5000GBï¼Œé»˜è®¤å¹¶ä¸ä¼šç›´æ¥åˆ†é…ç»™åŸæœ‰åˆ†åŒºï¼ˆä¾‹å¦‚ï¼švdb1ï¼‰ï¼Œéœ€è¦æ‰‹åŠ¨æ“ä½œåˆ†é…ã€‚

å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

### 1. å¤‡ä»½æ•°æ®

#### æ¨èå¤‡ä»½æ–¹æ³•ï¼ˆ3é€‰1ï¼‰ï¼š

```bash
# æ–¹æ³•1ï¼šæœ¬åœ°ä¸´æ—¶å¤‡ä»½ï¼ˆéœ€æœ‰è¶³å¤Ÿç©ºé—´ï¼‰
mkdir /tmp/data_backup
rsync -avz --progress /data/ /tmp/data_backup/

# æ–¹æ³•2ï¼šå¤‡ä»½åˆ°å…¶ä»–ç£ç›˜/äº‘å­˜å‚¨
tar -czvf /mnt/other_disk/data_backup.tar.gz /data

# æ–¹æ³•3ï¼šä½¿ç”¨äº‘å¿«ç…§ï¼ˆå¦‚æœvdbæ˜¯äº‘ç£ç›˜ï¼‰
# é€šè¿‡é˜¿é‡Œäº‘/è…¾è®¯äº‘æ§åˆ¶å°å¯¹ç£ç›˜åˆ›å»ºå¿«ç…§
```



### 2. æ‰©å®¹åˆ†åŒºæ“ä½œæµç¨‹

1. #### å¸è½½åˆ†åŒºå¹¶æ£€æŸ¥

   ```bash
   sudo umount /data
   lsblk | grep vdb1  # ç¡®è®¤å·²å¸è½½
   ```

2. #### åˆ é™¤æ—§åˆ†åŒºï¼ˆä¸ä¸¢å¤±æ•°æ®æŠ€å·§ï¼‰

   ```bash
   sudo parted /dev/vdb
   (parted) print      # è®°å½•vdb1çš„Startå€¼ï¼ˆå¦‚1049kBï¼‰
   (parted) rm 1
   (parted) quit
   ```

3. #### åˆ›å»ºæ–°åˆ†åŒºï¼ˆå…¨ç›˜åˆ†é…ï¼‰

   ```bash
   sudo parted /dev/vdb
   (parted) mkpart primary ext4 1049kB 100%  # ä½¿ç”¨ä¹‹å‰è®°å½•çš„Startå€¼
   (parted) align-check optimal 1           # æ£€æŸ¥å¯¹é½
   (parted) print                           # ç¡®è®¤æ–°åˆ†åŒºè¦†ç›–å…¨ç›˜
   (parted) quit
   ```

4. #### æ‰©å±•æ–‡ä»¶ç³»ç»Ÿï¼ˆæ— éœ€æ ¼å¼åŒ–ï¼‰

   ```bash
   # æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿç±»å‹
   sudo blkid /dev/vdb1 | grep -o 'TYPE="[^"]*"'
   
   # å¦‚æœæ˜¯ext2/3/4ï¼š
   sudo e2fsck -f /dev/vdb1     # å¼ºåˆ¶æ£€æŸ¥
   sudo resize2fs /dev/vdb1     # æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ
   
   # å¦‚æœæ˜¯xfsï¼š
   sudo xfs_growfs /dev/vdb1
   ```

5. #### é‡æ–°æŒ‚è½½å¹¶éªŒè¯

   ```bash
   sudo mount /dev/vdb1 /data
   df -h /data  # åº”æ˜¾ç¤ºâ‰ˆ4.9Tå®¹é‡
   ls /data     # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å®Œå¥½
   ```



### ğŸ” **å…³é”®æ³¨æ„äº‹é¡¹**

1. **åˆ†åŒºèµ·å§‹æ‰‡åŒºå¿…é¡»ä¸€è‡´**ï¼š

   - å¦‚æœæ–°åˆ†åŒºçš„Startå€¼ä¸åŸæ¥ä¸åŒï¼Œä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±
   - é€šè¿‡`parted /dev/vdb unit s print`æŸ¥çœ‹åŸå§‹æ‰‡åŒº

2. **æ–‡ä»¶ç³»ç»Ÿæ‰©å±•å¤±è´¥å¤„ç†**ï¼š

   ```bash
   # å¦‚æœresizeå¤±è´¥ï¼Œå°è¯•å¤‡ä»½åé‡å»ºåˆ†åŒºï¼š
   sudo mkfs.ext4 /dev/vdb1  # ä¼šæ¸…é™¤æ‰€æœ‰æ•°æ®ï¼
   mount /dev/vdb1 /data
   rsync -av /tmp/data_backup/ /data/  # æ¢å¤å¤‡ä»½
   ```

3. **è‡ªåŠ¨åŒ–æŒ‚è½½é…ç½®**ï¼š

   ```bash
   # è·å–æ–°UUID
   sudo blkid /dev/vdb1
   # æ›´æ–°/etc/fstabï¼ˆä½¿ç”¨UUIDè€Œéè®¾å¤‡è·¯å¾„ï¼‰
   sudo vim /etc/fstab
   ```

------

### âœ… **æœ€ç»ˆéªŒè¯**

```bash
# æ£€æŸ¥åˆ†åŒºå¤§å°
sudo parted /dev/vdb print free | grep -A2 Number

# æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿå®Œæ•´æ€§
sudo fsck /dev/vdb1
```

å¦‚æœæ“ä½œä¸­é‡åˆ°ä»¥ä¸‹æƒ…å†µè¯·ç«‹å³åœæ­¢ï¼š

- `resize2fs` æç¤º"couldn't find valid filesystem"
- é‡æ–°æŒ‚è½½å/dataä¸ºç©º
  æ­¤æ—¶éœ€è¦ä»å¤‡ä»½æ¢å¤æ•°æ®ã€‚

