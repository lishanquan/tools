1. ### 问题描述

   挂载到一个原先有文件的目录下（以挂载到 `/home`为例子）
   
   当挂载时候发现新挂载`/home`到新硬盘时，`/home`原来数据变空了。
   
   
   
2. ### 问题原因

   原因：是由于`linux`的`VFS`（虚拟文件系统）机制导致的

   正常登录以后，所看到的各个目录，文件都是内核在加载时候构造在内存中的`VFS`目录树，而不是直接看到硬盘上的实际目录树。

   当你挂载某个设备到一个`VFS`挂载点上时(比如`/home`），系统就把VFS中的这个挂载点`/home`指向你最后所挂载的那个设备上。那么你现在访问该挂载点时，就会看到你最后挂载在此处的设备。而之前所挂载的设备依然在那里，只不过挂载点/home已经不再指向之前的设备。所以之前的数据是被隐藏了，但并没有删除，若`umount`挂载后，数据又重新回来了。

   

3. ### 解决办法

   1. ##### 先将硬盘挂载到一个新建的空目录作为跳板目录

      ```shell
      mkdir /new  
      ```

   2. ##### 将硬盘先挂载到跳板目录上

      ```shell
      #首先要查看硬盘是否挂载及其名称
      lsblk
      
      [root@lsq docker]# lsblk
      NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
      vda    253:0    0   80G  0 disk 
      └─vda1 253:1    0   80G  0 part /
      vdb    253:16   0  100G  0 disk 
      └─vdb1 253:17   0  100G  0 part /mnt
      ```

      

   3. ##### 挂载跳板目录

      ```shell
      mount /dev/vdb1 /new  
      ```

      

   4. ##### 将原要挂载的目录中所有文件复制过来

      ```shell
      #复制/home目录（你原本想挂载的目录）所有数据到/new先
      
      cp -R /home/*  /new  
      ```

      

   5. ##### 删除原目录下的所有文件

      ```shell
      #删除原先的文件，可选,主要为了腾出空间给原来的硬盘
      
      rm -rf /home/*       
      ```

      

   6. ##### 将硬盘挂载到原要挂载的目录

      ```shell
      #挂载/home 
      
      mount /dev/vdb1 /home 
      ```

      此时，你会发现之前的`/home`目录文件已经全部转移过来了，也许你会有点疑问，我并没有复制或移动`/new`文件到新挂载的`/home`目录啊，其实此时的`/home`目录相当于`/new`目录的硬链接，可以测试下`mkdir /new/test` 你会发现`/home`目录也存在`test`

      

   7. ##### 删除跳板目录

      ```shell
      #解除跳板目录挂载,可能会出现占用无法删除,可以使用 umount -fl 强行卸载,
      
      umount /new 
      
      # -f 强制卸载
      
      # -l 一空闲马上卸载所有占用的文件系统。
      
      #删除跳板目录
      rm -rf /new 
      ```

      

   8. 

4. 

5. 